<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

  <link rel="stylesheet" href="style.css">
  <script src="validacion.js" defer></script>
</head>

<body>
  <h1>Validación HTML</h1>

    
  <h2 style="margin-top:0">Registrar Película</h2>

  <!-- Para validar con JS necesitamos el atributo novalidate en el form o 
       cambiar el type del botón que provoca el evento submit -->
  <form method="get" action="#" id="frm" novalidate>
    <div>
      <label data-ayuda="Como máximo 20 caracteres.">Título:<br>
        <input type="text" id="titulo" name="titulo" placeholder="Ej: El Padrino" maxlength="20" required>
      </label>
    </div>

    <div>
      <label data-ayuda="Entre 1900 y 2030.">Año:<br>
        <input type="number" id="anio" name="anio" placeholder="Ej: 1972" size="12" min="1900" max="2030" required validationmessage="Yeah">
      </label>
    </div>

    <div>
      <label data-ayuda="Como máximo 25 caracteres.">Idioma Original:<br>
        <input type="text" id="idioma" name="idioma" placeholder="Ej: Inglés">
      </label>
    </div>

    <div>
      <label for="categoria">Categoría:</label>
      <select id="categoria" name="categoria" >
        <option value="aventura">Aventura</option>
        <option value="thriller">Thriller</option>
        <option value="comedia">Comedia</option>
        <option value="animacion">Animación</option>
      </select>
    </div>


    <div>
      <label data-ayuda="Como máximo 50 caracteres.">
        Elige un comentario:<br>
        <input list="comentarios" id="com" name="com" placeholder="Ej: Entretenida" required maxlength="50"/>
      </label>  
    </div>

    <datalist id="comentarios">  
      <option value="Entretenida"></option>
      <option value="No merece la pena"></option>
      <option value="Huye insensato"></option>
      <option value="Fantástica"></option>
      <option value="Perfecta"></option>
      <option value="Ni fu ni fa"></option>
    </datalist>  

    <div>
      <label data-ayuda="El código es una P seguida de un número de 4 cifras.">
        Código:<br>
        <input id="codigo" name="codigo" placeholder="Ej: P4123" required pattern="P\d{4}"/>
      </label>
    </div>


    <p>Nota: los campos obligaotorios están marcados con un *. En rojo se resaltarán los datos incorrectos.</p>

    <div>
      <button>Guardar</button>
    </div>
  </form>

  <div id="divErrores" class="errores"></div>


  <script>
    // Cambiamos el mensaje por defecto, no muy recomendable de todas formas
    document.querySelector("#anio").addEventListener("input", e=>{
      //Restauramos la validez por defecto
      anio.setCustomValidity("");

      //Comprobamos la validez
      if(!anio.checkValidity()){
      
        // cambiamos el mensaje del navegador
        anio.setCustomValidity("Tenlo en cuenta, colega: el año debe estar entre 1900 y 2030");
      
        // mostramos el mensaje
        anio.reportValidity();
      }
    });
  </script>
  
</body>
</html>